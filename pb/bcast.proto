syntax = "proto3";
package crdt.pb;

option go_package=".;pb";

message StateBroadcast {
  map<string,Participant>  Members = 1; // Map of participants
}

message Participant {
  uint64 BestBefore = 1;        // Timestamp for garbage collection
  repeated Head DagHeads = 2;   // List of DAG heads
  map<string,string> metadata = 3;   // A map to hold arbitrary metadata about the participant
  Snapshot Snapshot = 4;  // latest HAMT snapshot head
}

message Head {
  bytes Cid = 1; // CID representing a head
}

message Snapshot {
  Head SnapshotKey = 1;         // HAMT wrapper root
  Head DagHead     = 2;         // DAG node that was compacted
  uint64 Height    = 3;         // DAG height at compaction
}